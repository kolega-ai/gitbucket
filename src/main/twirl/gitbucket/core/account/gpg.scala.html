@(account: gitbucket.core.model.Account, gpgKeys: List[gitbucket.core.model.GpgKey], csrfToken: String)(implicit context: gitbucket.core.controller.Context)
@import gitbucket.core.ssh.SshUtil
@gitbucket.core.html.main("GPG Keys"){
  @gitbucket.core.account.html.menu("gpg", context.loginAccount.get.userName, false){
    <div class="panel panel-default">
      <div class="panel-heading strong">GPG Keys</div>
      <div class="panel-body">
        @if(gpgKeys.isEmpty){
          No keys
        } else {
          @gpgKeys.zipWithIndex.map { case (key, i) =>
            @if(i != 0){
              <hr>
            }
            <div style="margin-bottom: 10px;">
              <strong style="line-height: 30px;">@key.title</strong> (@key.gpgKeyId.toHexString.toUpperCase)
              <form method="POST" action="@context.path/@account.userName/_gpg/delete/@key.keyId" style="display: inline; float: right;" onsubmit="return confirm('Are you sure you want to delete this GPG key?');">
                <input type="hidden" name="_csrf_token" value="@csrfToken" />
                <button type="submit" class="btn btn-sm btn-danger">Delete</button>
              </form>
            </div>
          }
        }
      </div>
    </div>
    <form method="POST" action="@context.path/@account.userName/_gpg" validate="true" autocomplete="off">
      @* CSRF Protection Hidden Field *@
      <input type="hidden" name="_csrf_token" value="@csrfToken" />
      
      <div class="panel panel-default">
        <div class="panel-heading strong">Add a GPG Key</div>
        <div class="panel-body">
          <fieldset class="form-group">
            <label for="title" class="strong">Title</label>
            <div><span id="error-title" class="error"></span></div>
            <input type="text" name="title" id="title" class="form-control"/>
          </fieldset>
          <fieldset class="form-group">
            <label for="publicKey" class="strong">Key</label>
            <div><span id="error-publicKey" class="error"></span></div>
            <textarea name="publicKey" id="publicKey" class="form-control" style="height: 200px;"></textarea>
          </fieldset>
          <input type="submit" class="btn btn-success" value="Add"/>
        </div>
      </div>
    </form>
  }
}
